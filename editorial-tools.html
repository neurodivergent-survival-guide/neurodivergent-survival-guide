---
layout: default
title: Editorial Tools
permalink: /editorial-tools/
---
<!-- File: _pages/editorial-tools.html -->

<style>
    .tool-section {
        margin-bottom: 40px;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 20px;
        background-color: #fafafa;
    }
    .tool-section h2 {
        color: #34495e;
        margin-top: 0;
        border-bottom: 2px solid #3498db;
        padding-bottom: 10px;
    }
    .page-card {
        border: 1px solid #ddd;
        border-radius: 8px;
        margin: 15px 0;
        padding: 15px;
        background-color: white;
    }
    .page-card.collapsed .collapsible-content {
        display: none;
    }
    .page-title {
        font-size: 18px;
        font-weight: bold;
        color: #2c3e50;
        margin-bottom: 5px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    .toggle-icon {
        font-size: 14px;
        color: #7f8c8d;
    }
    .page-link {
        color: #3498db;
        text-decoration: none;
        font-size: 14px;
    }
    .page-link:hover {
        text-decoration: underline;
    }
    .search-term {
        background-color: #3498db;
        color: white;
        padding: 3px 8px;
        border-radius: 12px;
        font-size: 12px;
        margin: 2px;
        display: inline-block;
    }
    .jargon-term {
        background-color: #9b59b6;
        color: white;
        padding: 3px 8px;
        border-radius: 12px;
        font-size: 12px;
        margin: 2px;
        display: inline-block;
    }
    .count-good {
        color: #27ae60;
        font-weight: bold;
    }
    .count-warning {
        color: #f39c12;
        font-weight: bold;
    }
    .count-error {
        color: #e74c3c;
        font-weight: bold;
    }
    .strategy-section {
        margin: 5px 0;
        padding: 5px;
        background-color: #f8f9fa;
        border-radius: 3px;
    }
    .jargon-list {
        margin: 10px 0;
        padding: 10px;
        background-color: #f8f9fa;
        border-radius: 5px;
        border-left: 4px solid #9b59b6;
    }
    .collapsible-content {
        margin-top: 10px;
    }
    .toc {
        background-color: #ecf0f1;
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 30px;
    }
    .toc h3 {
        margin-top: 0;
        color: #2c3e50;
    }
    .toc-section {
        margin-bottom: 15px;
    }
    .toc-section h4 {
        margin: 5px 0;
        color: #34495e;
        font-size: 16px;
    }
    .toc-link {
        display: inline-block;
        margin: 2px 5px;
        padding: 3px 8px;
        background-color: #bdc3c7;
        color: #2c3e50;
        text-decoration: none;
        border-radius: 4px;
        font-size: 12px;
    }
    .toc-link:hover {
        background-color: #95a5a6;
        color: white;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
    }
    th, td {
        padding: 10px;
        text-align: left;
        border-bottom: 1px solid #ddd;
    }
    th {
        background-color: #f2f2f2;
        font-weight: bold;
    }
</style>

<h1>Editorial Tools</h1>

<!-- Table of Contents -->
<div class="toc">
    <h3>Table of Contents - Struggle Pages</h3>
    {% assign struggle_pages = site.pages | where: "layout", "struggle" %}
    {% assign pages_by_condition = struggle_pages | group_by: "condition" %}
    
    {% for condition_group in pages_by_condition %}
        <div class="toc-section">
            <h4>{{ condition_group.name | upcase }}</h4>
            {% for page in condition_group.items %}
                <a href="#page-{{ forloop.index }}-{{ condition_group.name }}" class="toc-link">{{ page.title }}</a>
            {% endfor %}
        </div>
    {% endfor %}
</div>

<script>
function togglePageCard(element) {
    const card = element.closest('.page-card');
    const icon = element.querySelector('.toggle-icon');
    
    card.classList.toggle('collapsed');
    
    if (card.classList.contains('collapsed')) {
        icon.textContent = '▶';
    } else {
        icon.textContent = '▼';
    }
}

function extractJargonTermsFromHTML(htmlContent) {
    // Create a temporary container
    const container = document.createElement('div');
    container.innerHTML = htmlContent;
    
    // Find all elements with class 'jargon'
    const jargonElements = container.querySelectorAll('.jargon');
    const uniqueTerms = new Set();
    
    jargonElements.forEach(jargonEl => {
        // Clone the element to avoid modifying the original
        const clone = jargonEl.cloneNode(true);
        
        // Remove all tooltip spans from the clone
        const tooltips = clone.querySelectorAll('.tooltip');
        tooltips.forEach(tooltip => tooltip.remove());
        
        // Get the remaining text content (which should be the jargon term)
        const jargonText = clone.textContent.trim();
        
        if (jargonText) {
            // Normalize: lowercase and clean whitespace
            const normalized = jargonText.toLowerCase().replace(/\s+/g, ' ');
            uniqueTerms.add(normalized);
        }
    });
    
    return Array.from(uniqueTerms).sort();
}

function analyzeJargonForPage(pageContent, pageId) {
    try {
        const uniqueTerms = extractJargonTermsFromHTML(pageContent);
        const count = uniqueTerms.length;
        
        // Update count display
        const countElement = document.getElementById('jargon-count-' + pageId);
        if (countElement) {
            let className = 'count-warning';
            let status = '';
            
            if (count >= 18 && count <= 25) {
                className = 'count-good';
            } else if (count < 18) {
                status = ' (low)';
            } else {
                className = 'count-error';
                status = ' (high)';
            }
            
            countElement.innerHTML = `<span class="${className}">${count}${status}</span>`;
        }
        
        // Update terms display
        const termsElement = document.getElementById('jargon-terms-' + pageId);
        if (termsElement) {
            if (uniqueTerms.length > 0) {
                termsElement.innerHTML = uniqueTerms.map(term => 
                    `<span class="jargon-term">${term}</span>`
                ).join('');
            } else {
                termsElement.innerHTML = '<em>No jargon terms found</em>';
            }
        }
        
        return count;
    } catch (error) {
        console.error('Error analyzing jargon for page', pageId, error);
        return 0;
    }
}

document.addEventListener('DOMContentLoaded', function() {
    // Initialize all cards as collapsed
    document.querySelectorAll('.page-card').forEach(card => {
        card.classList.add('collapsed');
        const icon = card.querySelector('.toggle-icon');
        if (icon) icon.textContent = '▶';
    });
    
    // Since we can't safely pass page content via JavaScript, 
    // we'll fetch each page individually to analyze jargon
    const pageUrls = [
        {% for condition_group in pages_by_condition %}
            {% for page in condition_group.items %}
                {% assign page_counter = page_counter | plus: 1 %}
                {% assign unique_id = page_counter | append: '-' | append: condition_group.name %}
                {
                    url: '{{ page.url | relative_url }}',
                    id: '{{ unique_id }}'
                },
            {% endfor %}
        {% endfor %}
    ];
    
    let optimalJargonPages = 0;
    let processedPages = 0;
    const totalPages = pageUrls.length;
    
    // Process each page by fetching it
    pageUrls.forEach(async (pageInfo) => {
        try {
            const response = await fetch(pageInfo.url);
            const html = await response.text();
            
            // Parse the HTML to extract content
            const parser = new DOMParser();
            const doc = parser.parseFromString(html, 'text/html');
            
            // Find the main content area
            const contentArea = doc.querySelector('.content-card') || doc.querySelector('main') || doc.body;
            const contentHtml = contentArea ? contentArea.innerHTML : html;
            
            const count = analyzeJargonForPage(contentHtml, pageInfo.id);
            
            if (count >= 18 && count <= 25) {
                optimalJargonPages++;
            }
            
            processedPages++;
            
            // Update summary when all pages are processed
            if (processedPages === totalPages) {
                document.getElementById('jargon-summary-count').textContent = optimalJargonPages;
                document.getElementById('jargon-summary-percent').textContent = Math.round((optimalJargonPages * 100) / totalPages) + '%';
            }
        } catch (error) {
            console.error('Error fetching/processing page:', pageInfo.url, error);
            
            // Show error in the UI
            const countElement = document.getElementById('jargon-count-' + pageInfo.id);
            const termsElement = document.getElementById('jargon-terms-' + pageInfo.id);
            
            if (countElement) {
                countElement.innerHTML = '<span class="count-error">Fetch Error</span>';
            }
            if (termsElement) {
                termsElement.innerHTML = '<em>Could not fetch page content</em>';
            }
            
            processedPages++;
            
            // Still update summary
            if (processedPages === totalPages) {
                document.getElementById('jargon-summary-count').textContent = optimalJargonPages;
                document.getElementById('jargon-summary-percent').textContent = Math.round((optimalJargonPages * 100) / totalPages) + '%';
            }
        }
    });
});
</script>

<!-- Search Terms Overview -->
<div class="tool-section">
    <h2>🔍 Search Terms Overview</h2>
    <p>Review all search terms across struggle pages for clinical language or overly formal terms.</p>
    
    {% assign page_counter = 0 %}
    {% for condition_group in pages_by_condition %}
        {% for page in condition_group.items %}
            {% assign page_counter = page_counter | plus: 1 %}
            {% assign unique_id = page_counter | append: '-' | append: condition_group.name %}
            
            <div class="page-card" id="page-{{ unique_id }}">
                <div class="page-title" onclick="togglePageCard(this)">
                    <span class="toggle-icon">▶</span>
                    {{ page.title }}
                </div>
                
                <div class="collapsible-content">
                    <a href="{{ page.url | relative_url }}" class="page-link">View Page</a> | 
                    <a href="https://github.com/neurodivergent-survival-guide/neurodivergent-survival-guide/edit/main{{ page.path }}" class="page-link" target="_blank">Edit on GitHub</a>
                    
                    {% if page.search_terms %}
                        <div style="margin: 10px 0;">
                            <strong>Search Terms:</strong><br>
                            {% for term in page.search_terms %}
                                <span class="search-term">{{ term }}</span>
                            {% endfor %}
                        </div>
                    {% else %}
                        <div style="margin: 10px 0; color: #e74c3c;">
                            <strong>⚠️ No search terms found</strong>
                        </div>
                    {% endif %}
                </div>
            </div>
        {% endfor %}
    {% endfor %}
</div>

<!-- Coping Strategy Counter -->
<div class="tool-section">
    <h2>📝 Coping Strategy Counter</h2>
    <p>Count list items in coping sections to ensure 5-8 strategies (not always 8).</p>
    
    {% assign page_counter = 0 %}
    {% for condition_group in pages_by_condition %}
        {% for page in condition_group.items %}
            {% assign page_counter = page_counter | plus: 1 %}
            {% assign unique_id = page_counter | append: '-' | append: condition_group.name %}
            {% assign content = page.content %}
            
            <!-- Count li elements in immediate-help section -->
            {% assign next_five_section = content | split: '<div class="immediate-help">' | last | split: '</div>' | first %}
            {% assign next_five_lis = next_five_section | split: '<li>' | size | minus: 1 %}
            
            <!-- Count li elements in long-term section -->
            {% assign long_term_section = content | split: '<div class="long-term">' | last | split: '</div>' | first %}
            {% assign long_term_lis = long_term_section | split: '<li>' | size | minus: 1 %}
            
            <div class="page-card">
                <div class="page-title" onclick="togglePageCard(this)">
                    <span class="toggle-icon">▶</span>
                    {{ page.title }}
                </div>
                
                <div class="collapsible-content">
                    <a href="{{ page.url | relative_url }}" class="page-link">View Page</a> | 
                    <a href="https://github.com/your-repo/edit/main{{ page.path }}" class="page-link" target="_blank">Edit on GitHub</a>
                    
                    <div class="strategy-section">
                        <strong>Next 5 Minutes:</strong> 
                        {% if next_five_lis >= 5 and next_five_lis <= 8 %}
                            <span class="count-good">{{ next_five_lis }} strategies</span>
                        {% else %}
                            <span class="count-warning">{{ next_five_lis }} strategies</span>
                        {% endif %}
                        (target: 5-8)
                    </div>
                    
                    <div class="strategy-section">
                        <strong>Long-term Solutions:</strong> 
                        {% if long_term_lis >= 5 and long_term_lis <= 8 %}
                            <span class="count-good">{{ long_term_lis }} strategies</span>
                        {% else %}
                            <span class="count-warning">{{ long_term_lis }} strategies</span>
                        {% endif %}
                        (target: 5-8)
                    </div>
                </div>
            </div>
        {% endfor %}
    {% endfor %}
</div>

<!-- Unique Jargon Terms Analysis -->
<div class="tool-section">
    <h2>💬 Unique Jargon Terms Analysis</h2>
    <p>Count unique jargon terms per page (target range: 18-25) and display all terms used.</p>
    
    {% assign page_counter = 0 %}
    {% for condition_group in pages_by_condition %}
        {% for page in condition_group.items %}
            {% assign page_counter = page_counter | plus: 1 %}
            {% assign unique_id = page_counter | append: '-' | append: condition_group.name %}
            
            <div class="page-card">
                <div class="page-title" onclick="togglePageCard(this)">
                    <span class="toggle-icon">▶</span>
                    {{ page.title }}
                </div>
                
                <div class="collapsible-content">
                    <a href="{{ page.url | relative_url }}" class="page-link">View Page</a> | 
                    <a href="https://github.com/your-repo/edit/main{{ page.path }}" class="page-link" target="_blank">Edit on GitHub</a>
                    
                    <div style="margin: 10px 0;">
                        <strong>Unique Jargon Terms:</strong> 
                        <span id="jargon-count-{{ unique_id }}">Analyzing...</span>
                        (target: 18-25)
                    </div>
                    
                    <div class="jargon-list">
                        <strong>Terms Used:</strong><br>
                        <div id="jargon-terms-{{ unique_id }}">Loading...</div>
                    </div>
                </div>
            </div>
        {% endfor %}
    {% endfor %}
</div>

<!-- Summary Statistics -->
<div class="tool-section">
    <h2>📊 Summary Statistics</h2>
    
    {% assign total_pages = struggle_pages | size %}
    {% assign pages_with_search_terms = 0 %}
    {% assign optimal_strategy_pages = 0 %}
    
    {% for page in struggle_pages %}
        {% if page.search_terms %}
            {% assign pages_with_search_terms = pages_with_search_terms | plus: 1 %}
        {% endif %}
        
        {% assign next_five_section = page.content | split: '<div class="immediate-help">' | last | split: '</div>' | first %}
        {% assign next_five_lis = next_five_section | split: '<li>' | size | minus: 1 %}
        {% assign long_term_section = page.content | split: '<div class="long-term">' | last | split: '</div>' | first %}
        {% assign long_term_lis = long_term_section | split: '<li>' | size | minus: 1 %}
        
        {% if next_five_lis >= 5 and next_five_lis <= 8 and long_term_lis >= 5 and long_term_lis <= 8 %}
            {% assign optimal_strategy_pages = optimal_strategy_pages | plus: 1 %}
        {% endif %}
    {% endfor %}
    
    <table>
        <tr>
            <th>Metric</th>
            <th>Count</th>
            <th>Percentage</th>
        </tr>
        <tr>
            <td>Total Struggle Pages</td>
            <td>{{ total_pages }}</td>
            <td>100%</td>
        </tr>
        <tr>
            <td>Pages with Search Terms</td>
            <td>{{ pages_with_search_terms }}</td>
            <td>{{ pages_with_search_terms | times: 100 | divided_by: total_pages }}%</td>
        </tr>
        <tr>
            <td>Optimal Strategy Count (5-8 each)</td>
            <td>{{ optimal_strategy_pages }}</td>
            <td>{{ optimal_strategy_pages | times: 100 | divided_by: total_pages }}%</td>
        </tr>
        <tr>
            <td>Optimal Jargon Count (18-25)</td>
            <td id="jargon-summary-count">Calculating...</td>
            <td id="jargon-summary-percent">Calculating...</td>
        </tr>
    </table>
</div>
