<!-- _layouts/default.html -->
<!DOCTYPE html>
<html lang="{{ site.lang | default: 'en-US' }}">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="page-layout" content="{{ page.layout | default: 'default' }}">
    
    <!-- Favicon links -->
    <link rel="icon" type="image/x-icon" href="{{ '/favicon.ico' | relative_url }}">
    <link rel="icon" type="image/png" sizes="32x32" href="{{ '/favicon-32x32.png' | relative_url }}">
    <link rel="icon" type="image/png" sizes="16x16" href="{{ '/favicon-16x16.png' | relative_url }}">
    <link rel="apple-touch-icon" sizes="180x180" href="{{ '/apple-touch-icon.png' | relative_url }}">
    
    {% if site.title and site.title != page.title %}
    <title>{{ page.title }} | {{ site.title }}</title>
    {% else %}
    <title>{{ page.title }}</title>
    {% endif %}
    
    <!-- SEO Meta Tags for struggle pages -->
    {% if page.layout == 'struggle' %}
    <meta name="description" content="{% if page.description %}{{ page.description }}{% else %}{{ page.title }} - {{ page.subtitle }}{% endif %}">
    <meta name="keywords" content="{{ page.condition }}, {{ page.title | downcase }}, neurodivergent, mental health, coping strategies, {% if page.search_terms %}{{ page.search_terms | join: ', ' }}{% endif %}">
    <link rel="canonical" href="{{ site.url }}{{ page.url }}">

    <!-- Open Graph Tags -->
    <meta property="og:title" content="{{ page.title }}{% if page.subtitle %} - {{ page.subtitle }}{% endif %}">
    <meta property="og:description" content="{% if page.description %}{{ page.description }}{% else %}{{ page.title }} - {{ page.subtitle }}{% endif %}">
    <meta property="og:type" content="article">
    <meta property="og:url" content="{{ site.url }}{{ page.url }}">
    <meta property="og:site_name" content="The Neurodivergent Survival Guide">

    <!-- Twitter Card Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ page.title }}{% if page.subtitle %} - {{ page.subtitle }}{% endif %}">
    <meta name="twitter:description" content="{% if page.description %}{{ page.description }}{% else %}{{ page.title }} - {{ page.subtitle }}{% endif %}">

    <!-- Schema.org Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "HealthTopicSummary",
        "name": "{{ page.title }}",
        "description": "{% if page.description %}{{ page.description }}{% else %}{{ page.title }} - {{ page.subtitle }}{% endif %}",
        "url": "{{ site.url }}{{ page.url }}",
        "dateModified": "{{ page.last_modified_at | default: site.time | date_to_xmlschema }}",
        "publisher": {
            "@type": "Organization",
            "name": "The Neurodivergent Survival Guide"
        },
        "about": {
            "@type": "MedicalCondition",
            "name": "{% if page.condition == 'adhd' %}ADHD{% elsif page.condition == 'autism' %}Autism{% elsif page.condition == 'bipolar' %}Bipolar Disorder{% elsif page.condition == 'bpd' %}Borderline Personality Disorder{% elsif page.condition == 'ocd' %}OCD{% endif %}"
        }
    }
    </script>
    {% endif %}
    
    <!-- General SEO for non-struggle pages -->
    {% unless page.layout == 'struggle' %}
    {% if page.description %}
    <meta name="description" content="{{ page.description }}">
    {% endif %}
    {% if site.url %}
    <link rel="canonical" href="{{ site.url }}{{ page.url }}">
    {% endif %}
    {% endunless %}
    
    <link rel="stylesheet" href="{{ '/assets/css/disclaimer-banner.css' | relative_url }}">
    
    <style>
        /* Global mobile optimization */
        * {
            box-sizing: border-box;
        }
        html {
            overflow-x: hidden;
            width: 100%;
        }
        body {
            overflow-x: hidden;
            width: 100%;
            max-width: 100vw;
            margin: 0;
            padding: 0;
        }
        /* Mobile-safe tooltip positioning */
        @media (max-width: 768px) {
            .tooltip {
                position: fixed !important;
                bottom: 20px !important;
                left: 20px !important;
                right: 20px !important;
                transform: none !important;
                max-width: none !important;
                width: auto !important;
                z-index: 9999 !important;
                box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
                border-radius: 12px;
            }
            
            .tooltip::after {
                display: none !important;
            }
            
            .tooltip::before {
                content: "âœ• Tap anywhere to close";
                display: block;
                font-size: 0.75rem;
                opacity: 0.8;
                margin-bottom: 0.5rem;
                padding-bottom: 0.5rem;
                border-bottom: 1px solid rgba(255, 255, 255, 0.3);
                text-align: center;
            }
            
            /* Ensure all containers stay within viewport */
            .container,
            .content-card,
            .header,
            .breadcrumb {
                max-width: 100vw !important;
                overflow-x: hidden;
            }
            
            /* Force text wrapping */
            p, h1, h2, h3, h4, h5, h6, li {
                word-wrap: break-word;
                overflow-wrap: break-word;
                hyphens: auto;
            }
            
            /* Prevent fixed-width elements from causing overflow */
            img, video, iframe, table {
                max-width: 100% !important;
                height: auto !important;
            }
            
            /* Mobile-safe grid adjustments */
            .characteristics-grid,
            .struggles-grid {
                grid-template-columns: 1fr !important;
                gap: 1rem !important;
            }
            
            /* Responsive padding */
            .header,
            .breadcrumb,
            .container {
                padding-left: 1rem !important;
                padding-right: 1rem !important;
            }
            
            .content-card,
            .condition-intro,
            .reframe-box,
            .struggles-section,
            .cross-cutting-section,
            .co-occurring {
                padding-left: 1rem !important;
                padding-right: 1rem !important;
                margin-left: 0 !important;
                margin-right: 0 !important;
            }
        }
        
        @media (max-width: 480px) {
            .tooltip {
                left: 10px !important;
                right: 10px !important;
                bottom: 10px !important;
            }
        }
    </style>
</head>
<body data-layout="{{ page.layout | default: 'default' }}">
    {{ content }}
    <script src="{{ '/assets/js/disclaimer-banner.js' | relative_url }}"></script>
</body>
</html>
